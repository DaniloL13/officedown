---
title: "Cross references"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Cross references}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{css, echo = FALSE}
img {
  width: 85%;
  display: block;
  margin-left: auto;
  margin-right: auto;
  margin-top: 5px;
  margin-bottom: 5px;
}
.medium > p > img {
  width: 50%;
}
.small > p > img {
  width: 30%;
}
```

## Introduction

The functionality is particularly interesting when using bookdown. 
It solves an issue that happens when the document is modified in 
its structure (chapters moved, graphics added manually) or 
integrated into another Word document:

> After generating a Microsoft Word document, users have to manually 
click on the image, insert a new caption with the original caption 
defined in the markdown document, insert a ":" after "Figure X" 
and remove the caption generated by the pandoc.

## Word references

The R markdown format `officedown::rdocx_document` is transforming 
R Markdown table and figure captions into proper Word captions that support 
automatic numbering. 

In the knitr chunks settings, specify: 

* the caption with the `fig.cap' (or `tab.cap') parameter
* specify its Word reference ID with the `fig.id' (or `tab.id') parameter
* and the paragraph style associated with the caption with 
the `fig.cap.style' (or `fig.tab.style') parameter.

![](../man/figures/CR-r-chunk.png)




It will produce an auto-numbered caption associated with a bookmark:

::: medium

![](../man/figures/CR-caption-bookmark.png)
:::

## Cross References

You can then refer to this caption with bookdown syntax: 

```
This is a linked reference to a figure: \@ref(fig:tsplot)
```


![](../man/figures/CR-reference_hover.png)


To refer to simple document id, use syntax `\@ref(an_id)`:

